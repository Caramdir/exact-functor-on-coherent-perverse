\documentclass[english,biblatex-alpha]{short-notes}

\title{exact functors on perverse coherent sheaves}
\author{Clemens Koppensteiner}

\usepackage{math-ag}

\addbibresource{global.bib}
%\bibliography{global.bib}

\newcommand\dualize{\mathbb D}
\newcommand\lc[1]{\Gamma_{\mkern-3mu#1}}

\begin{document}

\maketitle
%\tableofcontents

\begin{abstract}
    Inspired by symplectic geometry and a microlocal characterizations of constructible perverse sheaves we consider an alternative definition of perverse coherent sheaves as the category consisting of coherent sheaves $\sheaf F ∈ D^b_c(X_G)$ for which $RΓ_Z\sheaf F$ is concentrated in degree $0$ for special subvarieties $Z$ of $X$.
    These subvarieties are analogs of Lagrangians in the symplectic case.
\end{abstract}

\cgsIntro

\section{Introduction}

For motivation let us consider a complex manifold $X$ and the middle perversity on constructible sheaves on $X$.
This is a t-structure on the derived category $D_{\mathrm{const}}^b(X)$ of constructible sheaves on $X$.
One general way to obtain insights about the heart of a t-structure (e.g.\ perverse sheaves) is to study exact functors on the t-structure.
In the case of perverse sheaves on a complex manifolds, one can obtain a large amount of exact functors by taking vanishing cycles \cite[Corollary~10.3.13]{KashiwaraSchapira:1994:SheavesOnManifolds}.

Now consider a constructible perverse sheaf $\sheaf F$ on an affine Kähler manifold $X$, a point $x ∈ X$ and a suitably chosen holomorphic Morse function $f\colon X → ℂ$ with $f(x) = 0$ and single critical point $x$.
Then the stalk $(ϕ_{\!f}\sheaf F)_x$ is concentrated in cohomological degree $0$.
A more \enquote{geometric} formulation of this statement can be obtained in the following way.
Let $L$ be the stable manifold for the gradient of the Morse function $\Re f$.
Write $ι_x \colon \{x\} \hookrightarrow L$ and $ι_L\colon L \hookrightarrow X$ for the inclusions.
Then $ι_x^*ι_L^! \sheaf F$ is also concentrated in cohomological degree $0$.
Note that $L$ is a Lagrangian with respect to the symplectic structure given by the Kähler form.

Now consider a symplectic variety $X$ (in the sense of \cite{Beauville:2000:SymplecticSingularities}) with an action by a group $G$ such that the $G$-orbits give a symplectic foliation of $X$.
In this situation there is a middle perversity t-structure on the derived category $D_c^b(X_G)$ of \emph{coherent} $G$-equivariant sheaves (see Section~\ref{sec:Kashiwara} for a review of the theory of perverse coherent sheaves).
Let $L$ be a Lagrangian on $X$, i.e.\ a smooth subvariety that intersects every symplectic leaf in a Lagrangian.
Let $\sheaf F ∈ D_c^b(X_G)$ be a perverse coherent sheaf on $X$.
Following the intuition obtained in the constructible case, is natural to ask whether the !-restriction $ι_L^!\sheaf F$ of $\sheaf F$ to $L$ is concentrated in degree $0$.

For an arbitrary variety $X$ with a $G$-action that has finitely many orbits, we define the notion of a \emph{measuring subvariety} as an analog of a Lagrangian in the symplectic case (Definition~\ref{def:measuring}).
Our main theorem (Theorem~\ref{thm:main}) then states that a coherent sheaf $\sheaf F ∈ D^b_c(X_G)$ is perverse if and only if $ι_Z^!\sheaf F$ is concentrated in cohomological degree $0$ for all measuring subvarieties $Z$ of $X$.

\begin{Ex}
    Let $N$ be the nilpotent cone in the complex Lie algebra $\liesl n$ and let $G = \SL n$ act on $N$ adjointly.
    Then the dimensions of the $G$-orbits in $N$ are known to be even dimensional.
    Thus there exists a middle perversity $p$ with $p(O) = \frac12 \dim O$ for each $G$-orbit $O$.
    Let $X$ be the flag variety for $\liesl n$ and $μ\colon T^*X → N$ the Springer resolution.
    Choose a point $x ∈ X$.
    Then $T_x^*X$ is a Lagrangian in $T^*X$ and one can show explicitly that $μ(T_x^*X)$ is a measuring subvariety of $N$.
    Thus a sheaf $\sheaf F ∈ D_c^b(N^G)$ is perverse if and only if $R\lc{μ(T_x^*X)}\sheaf F$ is concentrated in degree $0$ for all $x ∈ X$.
\end{Ex}

\subsection{Setup and notation}

Let $X$ be a finite-dimensional Noetherian separated scheme over an algebraically closed field $k$.
Let $G$ be an algebraic group over $k$ acting on $X$.
For the moment we include the possibility of the acting group being trivial (this will change in Section~\ref{sec:measuring}).
We write $X^{\mathrm{top}}$ for the subset of the Zariski space of $X$ consisting of generic points of $G$-invariant subschemes and equip $X^{\mathrm{top}}$ with the induced topology.

We write $D(X)$, $D_{qc}(X)$ and $D_c(X)$ for the derived category of $\O_X$-modules and its full subcategories consisting of complexes with quasi-coherent and coherent cohomology sheaves respectively.
The corresponding categories for $G$-equivariant sheaves (i.e.\ the categories for the quotient stack $[X/G]$) are denoted $D(X_G)$, $D_{qc}(X_G)$ and $D_c(X_G)$.
As usual, $D^b(X)$ (etc.) is the full subcategory of $D(X)$ consisting of complexes with cohomology in only finitely many degrees.
All functors are be derived, though we usually don't explicitly write the $R$ or $L$.

\begin{cgs}
    Any basic introduction to derived categories will be sufficient in order to understand this article.
    The correct construction of the derived category of equivariant sheaves is somewhat involved, but not really necessary here, since all constructions will factor through the forgetful functor to non-equivariant category.
    The $G$-action is only used as a way to introduce something akin to a stratification on $X$.
    The equivariance condition forces the coherent sheaves to be vector bundles on each orbit and reduces the possible maps between sheaves so that the cone of a map is of that form (cf.~the introduction of \cite{ArinkinBezrukavnikov:arXiv:PerverseCoherentSheaves}).
\end{cgs}

Let $Z$ be a closed subset of $X$.
For an $\O_X$-module $\sheaf F$ we let $\lc Z\sheaf F$ be the subsheaf of $\sheaf F$ of sections with support in $Z$ \cite[Varition~3 in IV.1]{Hartshorne:1966:ResiduesAndDuality}.
By abuse of notation, we simply write $\lc Z$ for the right-derived functor $R\lc Z\colon D_{qc}(X) → D_{qc}(X)$.
Note that $\lc Z$ only depends on the closed subset $Z$, and not on the structure of $Z$ as a subscheme.

Let $x$ be a (not necessarily closed) point of $x$ and $\sheaf F ∈ D^b(X)$.
Then $\mathbf ι_x^*\sheaf F = \sheaf F_x ∈ D^b(\catModules{\O_x})$ denotes the (derived) functor of talking stalks.
We further set $\mathbf ι_x^!\sheaf F = \mathbf ι_x^*\lc {\overline x}$, cf.~\cite[Varition~8 in IV.1]{Hartshorne:1966:ResiduesAndDuality}.

\begin{cgs}
    The original reference on local cohomology is \cite{SGA2}.
    A good English book about it is \cite{BrodmannSharp:1998:LocalCohomology}.
    Unfortunately, both texts don't use the formalism of derived categories and I don't know any comprehensive reference that develops local cohomology in that setting.
    However it should be pretty straightforward to translate the relevant results.
\end{cgs}

We assume that $X$ has a $G$-equivariant dualizing complex $\sheaf R$ (see \cite[Definition~1]{Bezrukavnikov:arXiv:PerverseCoherentSheaves}) which we assume to be normalized.
For $\sheaf F ∈ D(X)$ (or $D(X_G)$) we write $\dualize \sheaf F = \sheafHom_{\O_X}(\sheaf F,\sheaf R)$ for its dual.

\begin{cgs}
    Recall that the essential properties of the duality functor are:
    \begin{itemize}
        \item the functor $\dualize$ takes $D^b_{c}(X)$ to $D^b_c(X)$ (resp.~$D_c^b(X_G)$ to $D_c^b(X_G)$);
        \item for $\sheaf F ∈ D^b_c(X)$ (or $D^b_c(X_G)$), the natural morphism $\sheaf F → \dualize\dualize F$ is an isomorphism;
        \item for $x ∈ X$, $\mathbf ι_x^!(\sheaf R)$ is concentrated in degree $-\dim x$ (where $\dim x \coloneq \dim\overline x$).
    \end{itemize}
\end{cgs}

\section{Perverse coherent sheaves}
\label{sec:Kashiwara}%

A \emph{perversity} is a function $p\colon \{0,\dotsc,\dim X\} → ℤ$.
For $x ∈ X^{\mathrm{top}}$ we abuse notation and set $p(x) = p(\dim x)$.
Then $p\colon X^{\mathrm{top}} → ℤ$ is a perversity function in the sense of \cite{Bezrukavnikov:arXiv:PerverseCoherentSheaves}.
Note that with our definition we insist that $p(x)$ solely depends on the dimension of $\overline x$.
A perversity is called \emph{monotone} if it is decreasing and \emph{comonotone} if the \emph{dual perversity} $\overline p(n) \coloneq -n - p(n)$ is decreasing.
It is \emph{strictly monotone} (resp.~\emph{strictly comonotone}) if for all $x,y ∈ X^{\mathrm{top}}$ with $\dim x < \dim y$ one has $p(x) > p(y)$ (resp.~$\overline p(x) > \overline p(y)$).
Note that a strictly monotone perversity is not necessarily strictly decreasing (e.g.~if $X$ only has even-dimensional orbits).

Recall that if $p$ is a monotone and comonotone perversity then Bezrukavnikov (following Deligne) defines a t-structure on $D_c^b(X_G)$ by taking the following full subcategories (see \cite{Bezrukavnikov:arXiv:PerverseCoherentSheaves,ArinkinBezrukavnikov:arXiv:PerverseCoherentSheaves}):
\begin{align*}
    \perv[p] D^{≤0}(X) & = 
    \{ \sheaf F ∈ D_c^b(X_G) : \mathbf ι_x^*\sheaf F ∈ D^{≤p(x)}(\catModules{\O_x}) \text{ for all $x ∈ X^{\mathrm{top}}$}\}, \\
    \perv[p] D^{≥0}(X) & = 
    \{ \sheaf F ∈ D_c^b(X_G) : \mathbf ι_x^!\sheaf F ∈ D^{≥p(x)}(\catModules{\O_x}) \text{ for all $x ∈ X^{\mathrm{top}}$}\}.
\end{align*}
The heart of this t-structure is called the category of perverse sheaves (with respect to the perversity $p$).

\begin{cgs}
    The original paper \cite{Bezrukavnikov:arXiv:PerverseCoherentSheaves} is easier to understand (as it doesn't use stacks). 
    However \cite{ArinkinBezrukavnikov:arXiv:PerverseCoherentSheaves} uses better notation (in particular the $ℂ$-module and $\O$-module restriction functors are notationally differentiated).
    So I'd recommend reading the two papers in parallel.
\end{cgs}

In \cite{Kashiwara:2004:tStructureOnHolonomicDModuleCoherentOModules}, Kashiwara also gives a definition of a perverse t-structure on $D^b_{c}(X)$.
While we work in Bezrukavnikov's setting (i.e.\ on the equivariant derived category on a potentially singular scheme), we need a description of the perverse t-structure that is closer to the one Kashiwara uses.
This is accomplished in the following proposition.

\begin{Prop}
    \label{prop:equivDeligneKashiwara}%
    Let $\sheaf F ∈ D_c^b(X_G)$ and let $p$ be a monotone and comonotone perversity function.
    \begin{enumerate}[(a)]
        \item
            The following are equivalent:
            \begin{enumerate}[(i)]
                \item $\sheaf F ∈ \perv D^{≤0}(X)$, i.e.\ $\mathbf ι_x^*\sheaf F ∈ D^{≤p(x)}(\catModules{\O_x})$ for all $x ∈ X^{\mathrm{top}}$;
                \item $p(\dim \supp H^{k}(\sheaf F)) ≥ k$ for all $k$.
            \end{enumerate}
        \item
            If $p$ is strictly monotone, then the following are equivalent
            \begin{enumerate}[(i)]
                \item $\sheaf F ∈ \perv D^{\ge 0}(X)$, i.e.\ $\mathbf ι_x^!\sheaf F ∈ D^{≥p(x)}(\catModules{\O_x})$ for all $x ∈ X^{\mathrm{top}}$;
                \item $\lc {\overline x}\sheaf F ∈ D^{≥p(x)}(X)$ for all $x ∈ X^{\mathrm{top}}$;
                \item $\lc {Y}\sheaf F ∈ D^{≥p(\dim Y)}(X)$ for all $G$-invariant equidimensional closed subsets $Y$ of $X$;
                \item $\dim\left( \overline x ∩ \supp\left( H^k(\dualize F) \right) \right) ≤ -p(x) - k$ for all $x ∈ X^{\mathrm{top}}$ and all $k$.
            \end{enumerate}
    \end{enumerate}
\end{Prop}

A crucial fact that we will implicitly use quite often in the following is that the support of a coherent sheaf is closed\textcgs{\ (e.g.~\cite[Exercise~II.5.6c]{Hartshorne:AG})}.
In particular, this means that if $x$ is a generic point and $\sheaf F$ a coherent sheaf, then $\mathbf ι_x^* \sheaf F = 0$ if and only if $\res{\sheaf F}U = 0$ for some open set $U$ intersecting $\overline x$.

\begin{proof}\leavevmode
    \begin{enumerate}[(a)]
        \item
            First let $\sheaf F ∈ \perv D^{≤0}(X)$ and assume for contradiction that there exists an integer $k$ such that $p(\dim \supp H^{k}(\sheaf F)) < k$.
            Let $x$ be the generic point of an irreducible component of $\supp H^{k}(\sheaf F)$.
            Then $H^k(\mathbf ι_x^* \sheaf F) \ne 0$. 
            But on the other hand, $\mathbf ι_x^*\sheaf F ∈ D^{≤p(x)}(\catModules{\O_x})$ and $p(x) = p(\dim \supp H^{k}(\sheaf F)) < k$, yielding a contradiction.

            Conversely assume that $p(\dim \supp H^{k}(\sheaf F)) ≥ k$ for all $k$ and let $x ∈ X^{\mathrm{top}}$.
            If $H^k(\mathbf ι_x^*\sheaf F) \ne 0$, then $\dim x ≤ \dim \supp H^{k}(\sheaf F)$.
            Thus monotonicity of the perversity implies that $\sheaf F ∈ \perv D^{≤0}(X)$.
        \item
            The implications from (iii) to (ii) and (ii) to (i) are trivial and the equivalence of (ii) and (iv) follows from Lemma~\ref{lem:supportAndLocalCohomology+}.
            Thus we only need to show that (i) implies (iii).
            So assume that $\sheaf F ∈ \perv D^{≥0}(X)$.
            We induct on the dimension of $Y$.
            
            If $\dim Y = 0$, then $\mathbf ι_Y^!\sheaf F = Γ(X,\lc Y)$ and thus $\lc Y\sheaf F ∈ D^{≥p(x)}(X)$ by assumption.

            Now let $\dim Y = d > 0$.
            We first assume that $Y$ is irreducible, i.e.\ $Y = \overline x$ for some $x ∈ X^{\mathrm{top}}$.
            Let $k < p(x)$.
            We have to show that $H^k(\lc {\overline x}\sheaf F) = 0$.

            We first show that $H^k(\lc {\overline x}\sheaf F)$ is coherent.
            Let $j\colon X \setminus {\overline x} \hookrightarrow X$.
            Consider the distinguished triangle
            \[
                \lc {\overline x} \sheaf F → \sheaf F → j_*j^* \sheaf F \xrightarrow{+1}.
            \]
            Applying cohomology to it we get an exact sequence
            \[
                H^{k-1}(j_*j^*\sheaf F) → H^k(\lc{\overline x} \sheaf F) → H^k(\sheaf F).
            \]
            Now, $k-1 < p(x) - 1 \le p(x) - 2$, so that $H^{k-1}(j_*j^*\sheaf F)$ is coherent by the Grothendieck finiteness theorem in the form of \cite[Corollary~3]{Bezrukavnikov:arXiv:PerverseCoherentSheaves}.
            As $H^k(\sheaf F)$ is coherent by assumption, this implies that $H^k(\lc{\overline x} \sheaf F)$ also has to be coherent.

            Set $Z = \supp H^k(\lc {\overline x}\sheaf F)$.
            Then, since $ι_x^* H^k(\lc {\overline x}\sheaf F)$ vanishes, $Z$ is a proper closed subset of $\overline x$.
            Consider the distinguished triangle
            \[
                H^k(\lc {\overline x}\sheaf F)[-k] →
                \lc {\overline x}\sheaf F →
                τ^{>k}\lc {\overline x}\sheaf F \xrightarrow{+1},
            \]
            and apply $\lc Z$ to it:
            \[
                H^k(\lc {\overline x}\sheaf F)[-k] →
                \lc Z \sheaf F →
                τ^{>k}\lc {Z}\sheaf F \xrightarrow{+1}.
            \]
            Since $\dim Z < d$, we can use the induction hypothesis to deduce that $\lc Z \sheaf F$ is in degrees at least $p(\dim Z) \ge p(x) > k$, as is $τ^{>k}\lc {Z}\sheaf F$.
            Hence $H^k(\lc {\overline x}\sheaf F)$ has to vanish.

            If $Y$ is not irreducible, let $Y₁$ be an irreducible component of $Y$ and $Y₂$ be the union of the other components.
            Then Mayer-Vietoris gives a distinguished triangle
            \[
                \lc {Y₁\cap Y₂} \sheaf F → \lc {Y₁} \sheaf F \oplus \lc{Y₂}\sheaf F → \lc{Y} \sheaf F \xrightarrow{+1},
            \]
            where $\lc {Y₁\cap Y₂} \sheaf F ∈ D^{\ge p(\dim Y₁\cap Y₂)}(X) \subseteq D^{\ge p(\dim Y)+1}$ (by strict monotonicity of $p$) and $\lc{Y₁} \sheaf F$ and $\lc{Y₂} \sheaf F$ are in $D^{\ge p(\dim Y)}(X)$ by induction on the number of components of $Y$.
            Thus $\lc Y \sheaf F ∈ D^{\ge p(\dim Y)}$, as required.
            \qedhere
    \end{enumerate}
\end{proof}

\begin{Lem}[{\cite[Proposition~5.2]{Kashiwara:2004:tStructureOnHolonomicDModuleCoherentOModules}}]
    \label{lem:supportAndLocalCohomology+}%
    Let $\sheaf F ∈ D_c^b(X)$, $Z$ a closed subset of $X$ and $n$ an integer.
    Then $\lc Z\sheaf F ∈ D_{qc}^{≥n}(X)$ if and only if $\dim(Z∩\supp(H^k(\dualize \sheaf F))) \le - k - n$ for all $k$.
\end{Lem}

\textcgs{An analogous lemma holds in the topological situations, see~\cite[Exercise~X.10]{KashiwaraSchapira:1994:SheavesOnManifolds}.}

This lemma just states that \cite[Proposition~5.2]{Kashiwara:2004:tStructureOnHolonomicDModuleCoherentOModules} holds on singular varieties as well.
The proof is same as for the smooth case, but we will include it here for completeness.

\begin{proof}
    By \cite[Proposition~VII.1.2]{SGA2}, $\lc Z\sheaf F ∈ D_{qc}^{\ge n}(X)$ if and only if 
    \begin{equation}
        \label{eq:supportAndCohomology+}%
        \sheafHom(\sheaf G,\sheaf F) ∈ D_c^{\ge n}(X)
    \end{equation}
    for all $\sheaf G ∈ \catCoh{X}$ with $\supp \sheaf G \subseteq Z$.
    Let $d(n) = -n$ be the dual standard perversity.
    Then by \cite[Lemma~5a]{Bezrukavnikov:arXiv:PerverseCoherentSheaves}, \eqref{eq:supportAndCohomology+} holds if and only if $\dualize \sheafHom(\sheaf G,\sheaf F) ∈ \perv[d] D^{\le -n}(X)$.
    By \cite[Proposition~V.2.6]{Hartshorne:1966:ResiduesAndDuality}, $\dualize \sheafHom(\sheaf G,\sheaf F) = \sheaf G \otimes_{\O_X} \dualize \sheaf F$, so that by Proposition~\ref{prop:equivDeligneKashiwara}(a) we need to show that
    \[
        \dim \supp H^{k}\left(\sheaf G \otimes_{\O_X} \dualize \sheaf F\right) \le - k - n 
    \]
    for all $k$.
    By \cite[Lemma~5.3]{Kashiwara:2004:tStructureOnHolonomicDModuleCoherentOModules} this is equivalent to
    \[
        \dim \left(Z∩\supp H^{k}(\dualize \sheaf F)\right) \le - k - n
    \]
    for all $k$ as required.
\end{proof}

\section{Measuring subvarieties}
\label{sec:measuring}%

From now on we assume that the $G$-action has finitely many orbits.

\begin{Def}
    \label{def:measuring}%
    Let $p$ be a perversity.
    A \emph{$p$-measuring subvariety} of $X$ is an equidimensional subvariety $Z$ of $X$ such that the following conditions hold for each $x ∈ X^{\mathrm{top}}$ with $\overline x ∩ Z \ne \emptyset$:
    \begin{itemize}
        \item $\dim(\overline x ∩ Z) = p(x) + \dim x$;
        \item $\overline x ∩ Z$ is the underlying variety of a regularly embedded subscheme\footnote{I.e., up to radical it is locally defined by exactly $-p(x)$ functions.} in $\overline x$.
    \end{itemize}

    We say that $X$ has \emph{enough $p$-measuring subvarieties} if for each $x ∈ X^{\mathrm{top}}$ there exists a $p$-measuring subvariety $Z$ with $Z ∩ \overline x \ne \emptyset$.
\end{Def}

\begin{Rem}
    \label{rem:existence}%
    Let $Z$ be a $p$-measuring subvariety.
    Then $\dim(\overline x ∩ Z) = -\overline p(x)$.
    Thus comonotonicity of $p$ ensures that if $\dim y ≤ \dim x$ then $\dim (\overline y ∩ Z) ≤ \dim (\overline x ∩ Z)$ for each $p$-measuring $Z$.
    Monotonicity of $p$ then further says that $\dim (\overline x ∩ Z) - \dim (\overline y ∩ Z) ≤ \dim x - \dim y$.
    Further, we clearly have $0 \le \dim(\overline x ∩ Z) \le \dim x$ and hence $-\dim x \le p(x) \le 0$.
    We show in Theorem~\ref{thm:existance} that these condition are actually sufficient for the existence of enough $p$-measuring subvarieties, at least when $X$ is affine.
\end{Rem}

\begin{Thm}
    \label{thm:main}%
    Let $p$ be a strictly monotone and (not necessarily strictly) comonotone perversity and assume that $X$ has enough $p$-measuring subvarieties.
    Then,
    \begin{enumerate}
        \item $\perv[p] D^{≤0}(X) = \{ \sheaf F ∈ D_c^b(X_G) : \lc Z\sheaf F ∈ D^{≤0}(X) \text{ for all $p$-measuring subvarieties $Z$}\}$;
        \item $\perv[p] D^{≥0}(X) = \{ \sheaf F ∈ D_c^b(X_G) : \lc Z\sheaf F ∈ D^{≥0}(X) \text{ for all $p$-measuring subvarieties $Z$}\}$.
    \end{enumerate}
    Therefore the sheaf $\sheaf F ∈ D_c^b(X_G)$ is perverse with respect to $p$ if and only if\/ $\lc Z\sheaf F$ is cohomologically concentrated in degree $0$ for each $p$-measuring subvariety $Z$.
\end{Thm}

The following lemma encapsulates the central argument for the proof of the first part of the theorem.

\begin{Lem}
    \label{lem:supportAndLocalCohomology-}%
    Let $\sheaf F ∈ \catCoh{X_G}$ be a $G$-equivariant coherent sheaf on $X$, let $p$ be a monotone perversity and let $n$ be an integer.
    Assume that $X$ has enough $p$-measuring subvarieties.
    Then the following are equivalent:
    \begin{enumerate}
        \item $p(\dim \supp \sheaf F) ≥ n$;
        \item $H^\ell(\lc Z\sheaf F) = 0$ for all $\ell ≥ -n+1$ and all measuring subvarieties $Z$.
    \end{enumerate}
\end{Lem}

Note that $H^\ell(\lc Z\sheaf F)$ means the $\ell$-th cohomology sheaf of the complex $R\lc Z\sheaf F$.
\textcgs{Also note that the lemma is only interesting for $n<0$.}

\begin{proof}
    Since $\supp \sheaf F$ is always a union of the closure of orbits, we can restrict to the support and assume that $\supp \sheaf F = X$.

    First assume that $p(\dim X) = p(\dim \supp \sheaf F) ≥ n$.
    By the definition of a $p$-measuring subvariety, this means that, up to radical, $Z$ can be locally defined by at most $-n$ equations.
    Thus $H^\ell(\lc Z\sheaf F) = 0$ for $\ell > -n$ \cite[Theorem~3.3.1]{BrodmannSharp:1998:LocalCohomology}. 

    Now assume conversely that $H^\ell(\lc Z\sheaf F) = 0$ for all $\ell ≥ -n+1$ and all measuring subvarieties $Z$.
    We have to show that $p(\dim \supp \sheaf F) ≥ n$.
    Set $d = \dim \supp \sheaf F$.
    Choose any $p$-measuring subvariety $Z$ that intersects $U$.
    Then $\codim_Z X = -p(d) ≥ -n + 1$.
    We will show that $H^{-p(d)}(\lc Z \sheaf F) \ne 0$ and hence $p(d) \ge n$ by assumption.
    Take some affine open subset $U$ of $X$ such that $U \cap Z$ is irreducible in $U$.
    It suffices to show that the cohomology is non-zero in $U$.
    Thus we can assume without loss of generality that $X$ is affine, say $X = \Spec A$, and $Z$ is irreducible.
    Write $Z = V(\ideal p)$ for some prime ideal $\ideal p$ of $A$.
    By flat base change \cite[Theorem~4.3.2]{BrodmannSharp:1998:LocalCohomology},
    \[
    Γ(X,H^{-p(d)}(\lc Z \sheaf F))_{\ideal p} = 
    \left(H_{\ideal p}^{-p(d)}(Γ(X,\sheaf F))\right)_{\ideal p} =
    H_{\ideal p_{\ideal p}}^{-p(d)}(Γ(X,\sheaf F)_{\ideal p})
    \]
    Since $\dim_X \supp \sheaf F = \dim X = d$, the dimension of the $A_{\ideal p}$-module $Γ(X,\sheaf F)_{\ideal p}$ is $-p(d)$.
    Thus by the Grothendieck non-vanishing theorem
    \cite[Theorem~6.1.4]{BrodmannSharp:1998:LocalCohomology}
    %\cite[Théorème~V.3.1]{SGA2}
    $H_{\ideal p_{\ideal p}}^{-p(d)}(Γ(X,\sheaf F)_{\ideal p}) \ne 0$ and hence $Γ(X,H^{-p(d)}(\lc Z \sheaf F)) \ne 0$ as required.
\end{proof}

\begin{proof}[Proof of Theorem~\ref{thm:main}]\leavevmode
\begin{enumerate}
\item 
    We use the description of $\perv[p] D^{≤0}(X)$ given by Proposition~\ref{prop:equivDeligneKashiwara}, i.e.
    \[
    \perv D^{≤0}(X) = \left\{ \sheaf F ∈ D_c^b(X_G) : p\left(\dim\left( \supp H^{n}(\sheaf F) \right)\right) ≥ n \text{ for all $n$}\right\}.
    \]
    We induct on the largest $k$ such that $H^k(\sheaf F) \ne 0$ to show that $\sheaf F ∈ \perv D^{≤0}$ if and only if $\lc Z\sheaf F ∈ D^{≤0}(X)$ for all $p$-measuring subvarieties $Z$.

    The equivalence is trivial for $k \ll 0$.
    For the induction step note that there is a distinguished triangle
    \[
    τ_{<k} \sheaf F → \sheaf F → H^k(\sheaf F)[-k] \xrightarrow{+1}.
    \]
    Applying the functor $\lc Z$ and taking cohomology we obtain an exact sequence
    \begin{multline*}
        \cdots →
        H¹(\lc Z(τ_{<k} \sheaf F)) →
        H¹(\lc Z\sheaf F) →
        H^{k+1}(\lc Z(H^k(\sheaf F))) → \\
        H²(\lc Z(τ_{<k} \sheaf F)) →
        H²(\lc Z\sheaf F) →
        H^{k+2}(\lc Z(H^k(\sheaf F))) →
        \cdots.
    \end{multline*}
    By induction, $H^\ell(\lc Z(τ_{<k} \sheaf F))$ vanishes for $\ell ≥ 1$ so that $H^\ell(\lc Z\sheaf F) \cong H^{k+\ell}(\lc Z(H^k(\sheaf F)))$ for $\ell ≥ 1$.
    Thus the statement follows from Lemma~\ref{lem:supportAndLocalCohomology-}.
\item 
    By Proposition~\ref{prop:equivDeligneKashiwara}(b), $\sheaf F ∈ \perv D^{≥0}$ if and only if
    \begin{align}
        \label{eq:main:+supp1}%
        & \dim\left( \overline x ∩ \supp\left( H^k(\dualize F) \right) \right) ≤ -p(x) - k &  \text{for all $x ∈ X^{\mathrm{top}}$ and all $k$}. \\
        %
        \intertext{Using Lemma~\ref{lem:supportAndLocalCohomology+} for $\lc Z\sheaf F ∈ D^{≥0}(X)$, we see that we have to show the equivalence of \eqref{eq:main:+supp1} with}
        %
        \notag
        & \dim\left( Z ∩ \supp\left( H^k(\dualize F) \right) \right) ≤ - k & \quad \text{ for all $k$ and $p$-measuring $Z$}. \\
        %
        \intertext{Since there are only finitely many orbits, this is in turn equivalent to}
        %
        \label{eq:main:+supp2}%
        & \dim\left( Z ∩ \overline x ∩ \supp\left( H^k(\dualize F) \right) \right) ≤ - k & \text{ $\forall\, x ∈ X^{\mathrm{top}}$, $k$ and $p$-measuring $Z$}.
    \end{align}
    We will show the equivalence for each fixed $k$ separately.
    Let us first show the implication from \eqref{eq:main:+supp1} to \eqref{eq:main:+supp2}.
    Since $H^k(\dualize \sheaf F)$ is $G$-equivariant and there are only finitely many $G$-orbits, it suffices to show \eqref{eq:main:+supp2} assuming that $\dim x \le \dim \supp H^k(\dualize F)$ and $\overline x \cap \supp H^k(\dualize F) \ne \emptyset$.
    Then $\dim\left(\overline x ∩ \supp\left( H^k(\dualize F) \right)\right) = \dim \overline x$.
    Thus,
    \begin{multline*}
        \dim\left(Z ∩ \overline x ∩ \supp\left( H^k(\dualize F) \right) \right) \le
        \dim(Z ∩ \overline x) =
        p(x) + \dim x = \\
        p(x) + \dim\left(\overline x ∩ \supp\left( H^k(\dualize F) \right)\right) \le
        p(x) - p(x) - k
        =k.
    \end{multline*}
    
    Conversely, assume that \eqref{eq:main:+supp2} holds for $k$.
    If $\overline x \cap \supp H^k(\dualize F) = \emptyset$, then \eqref{eq:main:+supp1} is trivially true.
    Otherwise choose a $p$-measuring $Z$ that intersects $\supp H^k(\dualize F)$.
    First assume that $\overline x$ is contained in $\supp H^k(\dualize F)$.
    Then
    \begin{multline*}
        \dim\left(\overline x ∩ \supp\left( H^k(\dualize F) \right)\right) =
        \dim x =
        -p(x) + \dim(Z ∩ \overline x) = \\
        -p(x) + \dim\left(Z ∩ \overline x ∩ \supp\left( H^k(\dualize F) \right) \right) \le
        -p(x) - k.
    \end{multline*}
    Otherwise $\overline x ∩ \supp\left( H^k(\dualize F) \right) = \overline y$ for some $y ∈ X^{\mathrm{top}}$ with $\dim y < \dim x$.
    Then \eqref{eq:main:+supp1} holds for $y$ and hence
    \[
    \dim\left( \overline x ∩ \supp\left( H^k(\dualize F) \right) \right) =
    \dim\left( \overline y ∩ \supp\left( H^k(\dualize F) \right) \right) ≤
    -p(y) - k ≤
    -p(x) - k
    \]
    by monotonicity of $p$.
    \qedhere
\end{enumerate}
\end{proof}

\begin{Ex}
    For the dual standard perversity $p(n) = -n$ (i.e.\ $p(x) = -\dim x$), we recover the definition of Cohen-Macaulay sheaves \cite[Section~IV.3]{Hartshorne:1966:ResiduesAndDuality}.
\end{Ex}

Of course, for the theorem to have any content, one needs to show that $X$ has in fact enough $p$-measuring subvarieties.
The next theorem shows that at least for affine varieties there are always enough measuring subvarieties whenever $p$ satisfies the obvious conditions (see Remark~\ref{rem:existence}).

\begin{Thm}
    \label{thm:existance}%
    Assume that $X$ is affine and the perversity $p$ satisfies $-n \le p(n) \le 0$ and is monotone and comonotone.
    Then $X$ has enough $p$-measuring subvarieties.
\end{Thm}

\begin{proof}
    Let $X = \Spec A$.
    We induct induct on the dimension $d$.
    More precisely, we induct on the following statement:
    \begin{quote}
        There exists a closed equidimensional subvariety $Z_d$ of $X$ such that for all $x ∈ X^{\mathrm{top}}$ the following holds:
        \begin{itemize}
            \item $Z_d \cap \overline x \ne \emptyset$ and $Z_d \cap \overline x$ is regularly embedded in $\overline x$;
            \item if $\dim x \le d$, then $\dim(\overline x ∩ Z_d) = p(x) + \dim x$;
            \item if $\dim x > d$, then $\dim(\overline x ∩ Z_d) = p(d) + \dim x$.
        \end{itemize}
    \end{quote}
    We set $p(-1) = 0$.
    The statement is trivially true for $d = -1$, e.g.~take $Z = X$.
    Assume that the statement is true for some $d \ge -1$.
    We want to show it for $d+1 \le \dim X$.

    If $p(d) = p(d+1)$, then $Z_{d+1} = Z_{d}$ works.
    Otherwise, by (co)monotonicity $p(d+1) = p(d) - 1$.
    Set $S = \bigcup \{ \overline x ∈ X^{\mathrm{top}} : \dim x \le d\}$.
    Since there are only finitely many orbits, we can choose a function $f$ \textcgs{(by choosing individual $f_i$ and multiplying them)} such that $f$ vanishes identically on $S$, $V(f)$ does not share a component with $Z_d$ and $V(f)$ intersects every $\overline x$ with $\dim x > d$.
    Then $Z_{d+1} = Z_d \cap V(f)$ satisfies the conditions.
\end{proof}

\printbibliography

\end{document}
