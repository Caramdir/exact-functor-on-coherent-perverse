\documentclass[english]{short-notes}

\title{Perverse sheaves and Lagrangians}
\author{Clemens Koppensteiner}

\usepackage{math-ag}

\addbibresource{global.bib}
%\bibliography{global.bib}

\newcommand\dualize{\mathbb D}

\newcommand\lm[2]{\csname lm#1#2\endcsname}
\expandafter\def\csname lm*!\endcsname#1#2{%
    Λ_{#1}Γ_{#2}%
}
\expandafter\def\csname lm!*\endcsname#1#2{%
    Γ_{#1}Λ_{#2}%
}

\begin{document}

\maketitle
\tableofcontents

\section{Setup and notation}

Let $X$ be a complex\footnote{This assumption is probably not necessary.} algebraic variety.
Let $G$ be a complex algebraic group acting on $X$ with finitely many orbits, so that all orbits are even-dimensional.
We write $D(X)$, $D_{qc}(X)$ and $D_c(X)$ for the derived category of $\O_X$-modules and its full subcategories consisting of complexes with quasi-coherent and coherent cohomology sheaves respectively.
The corresponding categories for $G$-equivariant sheaves (i.e.\ the categories for the quotient stack $[X/G]$) will be denoted $D(X^G)$, $D_{qc}(X^G)$ and $D_c(X^G)$.
As usual, $D^b(X)$ (etc.) will be the full subcategory of $D(X)$ consisting of complexes with cohomology in only finitely many degrees.
We functors will be derived, though we will usually drop the $R$ or $L$.

We assume that $X$ has a $G$-equivariant dualizing complex $\sheaf R$ (see \cite[Definition~1]{Bezrukavnikov:arXiv:PerverseCoherentSheaves}) which we assume to be normalized.
For $\sheaf F ∈ D(X)$ (or $D(X^G)$) we write $\dualize \sheaf F = \sheafHom_{\O_X}(\sheaf F,\sheaf R)$ for its dual.
Then we have
\begin{itemize}
    \item $\dualize\colon D^b_{c}(X) → D^b_c(X)$ (resp.~$\dualize\colon D^b(X^G) → D^b(X^G)$).
    \item For $\sheaf F ∈ D^b_c(X)$ (or $D^b_c(X^G)$), the natural morphism $\sheaf F → \dualize\dualize F$ is an isomorphism.
    \item For $x ∈ X$, $\mathbf ι_x^!(\sheaf R)$ is concentrated in $-\dim \bar x$ (where $\mathbf ι_x^!$ is the topological $!$-restriction and $\dim$ is the Krull dimension, see below), see \cite[Section~3.1]{Bezrukavnikov:arXiv:PerverseCoherentSheaves}.
\end{itemize}

Let $p$ be the middle perversity on $X$, i.e.\ $p(U) = -\frac12 \dim U$ for each $G$-orbit $U$.
The corresponding perverse t-structure on $D_c^b(X^G)$ will be denoted $(\perv D^{≤0}(X), \perv D^{≥0}(X))$ and elements of its heart will simply be called \emph{perverse sheaves} on $X$ (see \cite{Bezrukavnikov:arXiv:PerverseCoherentSheaves, ArinkinBezrukavnikov:arXiv:PerverseCoherentSheaves} for definitions).
Note that $\dualize \perv D^{≤0}(X) = \perv D^{≥0}(X)$.

Let $Z$ be a closed subset of $X$, and $\sheaf I$ an ideal sheaf of $\O_X$ such that $Z = \supp(\rquot{\O_X}{\sheaf I})$.
For an $\O_X$-module $\sheaf F$ we let $Γ_Z\sheaf F$ be subsheaf of $\sheaf F$ of sections with support in $Z$.
If $\sheaf F$ is quasi-coherent, then by \cite[Theorem~V.4.1]{Hartshorne:1966:ResiduesAndDuality} we have
\[
Γ_Z\sheaf F = \varinjlim_n \sheafHom_{\O_X}(\rquot{\O_X}{\sheaf I^n}, \sheaf F).
\]
Let $RΓ_Z\colon D(X) → D(X)$ be the right-derived functor of $Γ_Z$.
By \cite[Corollary~3.2.5(iii)]{TarrioLopezLipman:1997:LocalHomologyCohomologyOnSchemes} , $RΓ_Z$ maps $D_{qc}(X)$ to itself.
We will usually simply write $Γ_Z$ for $RΓ_Z$.

Dually, for an $\O_X$-module $\sheaf F$, let $Λ_Z\sheaf F$ be its completion along $Z$, i.e.\
\[
Λ_Z\sheaf F = \varprojlim_n \left( (\rquot{\O_X}{\sheaf I^n}) \otimes \sheaf F \right).
\]
The functor $Λ_Z$ is exact on coherent sheaves.
On quasi-coherent sheaves, we can still get a left-derived functor $LΛ_Z\colon D_{qc}(X) → D(X)$ (see \cite[Section~1]{TarrioLopezLipman:1997:LocalHomologyCohomologyOnSchemes}).
We will usually simply write $Λ_Z$ for $LΛ_Z$.

TODO: $\mathbf ι_Z^*$, $\mathbf ι_Z^!$.

\section{Measuring subvarieties}

\begin{Def}
    A \emph{measuring subvariety} of $X$ is an irreducible subvariety $Z$ of $X$ such that $\dim(U ∩ Z) = \frac12 \dim U$ for each $G$-orbit $U$ with $U ∩ Z \ne \emptyset$.
    A \emph{measuring pair} is a pair $(p,Z)$, consisting of a measuring subvariety $Z$ and a closed point $p ∈ Z$.
    Two measuring pairs $(p,Z)$ and $(p',Z')$ are called \emph{transversal} if $p = p'$ and $Z ∩ Z' = p$.
\end{Def}

TODO: Existence of measuring pairs (and transversal pairs of measuring pairs).

\begin{Def}
    Define two full subcategories of $D_c^b(X^G)$ by
    \begin{align*}
        \perv[L] D^{≤0}(X) &= \{ \sheaf F ∈ D_c^b(X^G) : Γ_Z \sheaf F ∈ D^{≤0}(X) \text{ for all measuring subvarieties $Z$}\}, \\
        \perv[L] D^{≥0}(X) &= \{ \sheaf F ∈ D_c^b(X^G) : Γ_pΛ_Z \sheaf F ∈ D^{≥0}(X) \text{ for all measuring pairs $(p,Z)$}\}.
    \end{align*}
\end{Def}

% The Lagrangian t-structures
% comparing the t-structures

\begin{Lem}
    \label{lem:duality}%
    $\dualize \perv[L] D^{≤0}(X) = \perv[L] D^{≥0}(X)$.
\end{Lem}

\begin{proof}
    Let $Z$ be a measuring subvariety and $\sheaf F ∈ D^b(X^G)$.
    Then by \cite[Corollary~5.2.2]{TarrioLopezLipman:1997:LocalHomologyCohomologyOnSchemes} we have for any closed point $p ∈ Z$,
    \[
    Γ_pΛ_Z(\dualize \sheaf F) \cong 
    Γ_p(\dualize Γ_Z \sheaf F) =
    Γ_p\sheafHom_{\O_X}(Γ_Z\sheaf F, \sheaf R).
    \]
    By \cite[Proposition~5.2.1]{TarrioLopezLipman:1997:LocalHomologyCohomologyOnSchemes} and \cite[Proposition~V.6.1]{Hartshorne:1966:ResiduesAndDuality} this is isomorphic to 
    \[
    \sheafHom_{\O_X}(Γ_Z\sheaf F, Γ_p\sheaf R) =
    \sheafHom_{\O_X}(Γ_Z\sheaf F, \sheaf I(p)),
    \]
    where $\sheaf I(p)$ is the skyscraper sheaf with stalk at $p$ the injective hull of the residue field at $p$.
    Thus $Γ_pΛ_Z\sheaf F$ is in non-negative degrees if and only if $(Γ_Z\sheaf F)_p$ is in non-positive degrees.
\end{proof}

% Thm: the Lagrangian t-structure is indeed a t-structure

\section{Agreement with perverse sheaves}

\begin{Lem}
    \label{lem:supportAndLocalCohomology}%
    Let $\sheaf F ∈ \catCoh{X^G}$ be a $G$-equivariant coherent sheaf on $X$ and let $n$ be an integer.
    Then the following are equivalent:
    \begin{enumerate}
        \item $\dim \supp \sheaf F ≤ 2n$;
        \item $H^l(Γ_Z\sheaf F) = 0$ for all $l ≥ n+1$.
    \end{enumerate}
\end{Lem}

\begin{proof}
    TODO.
\end{proof}

\begin{Thm}
    Let $\sheaf F ∈ D_c^b(X^G)$. 
    Then the following are equivalent:
    \begin{enumerate}
        \item $\sheaf F ∈ \perv D^{≤0}(X)$, i.e.\ $i_U^*\sheaf F ∈ D^{≤-\frac12 \dim U}(\catAbSheaves U)$;
        \item $\dim \left( \supp H^{-n}(\sheaf F) \right) ≤ 2n$ for all $n$;
        \item $\sheaf F ∈ \perv[L] D^{≤0}(X)$, i.e.\ $Γ_Z(\sheaf F) ∈ D^{≤0}(X)$.
    \end{enumerate}
    Consequently, $\perv[L] D^{≤0}(X) = \perv D^{≤0}(X)$ and $\perv[L] D^{≥0}(X) = \perv D^{≥0}(X)$.
\end{Thm}

The equivalence between (i) and (ii) is implicit in the definitions of the perverse t-structure given by Deligne and Arinkin--Bezrukavnikov \cite{ArinkinBezrukavnikov:arXiv:PerverseCoherentSheaves,Bezrukavnikov:arXiv:PerverseCoherentSheaves} on the one hand and Kashiwara \cite{Kashiwara:2004:tStructureOnHolonomicDModuleCoherentOModules} on the other.
However, I don't know any reference for this equivalence in the literature, so we will give a proof here.

\begin{proof}
    The last statement follows from the equivalence of (i) and (iii) by dualizing, i.e.\ with Lemma~\ref{lem:duality} and the corresponding statement for the perverse t-structure, see \cite[Lemma~5(a)]{Bezrukavnikov:arXiv:PerverseCoherentSheaves}.
%    All measurements are local, so we can assume that $X$ is affine and set $X = \Spec A$.

    TODO (i) <=> (ii)

    We will now show the equivalence of (ii) and (iii).
    To do so we will use induction on the largest $k$ such that $H^k(\sheaf F) \ne 0$.

    The equivalence is trivial for $k \ll 0$.
    For the induction step note that there is a distinguished triangle
    \[
    τ_{≤ k-1} \sheaf F → \sheaf F → H^k(\sheaf F)[-k] \xrightarrow{+1}.
    \]
    Applying the functor $Γ_Z$ and taking cohomology we obtain 
    \begin{multline*}
    \cdots →
    H¹(Γ_Z(τ_{≤ k-1} \sheaf F)) →
    H¹(Γ_Z\sheaf F) →
    H^{k+1}(Γ_Z(H^k(\sheaf F))) → \\
    H²(Γ_Z(τ_{≤ k-1} \sheaf F)) →
    H²(Γ_Z\sheaf F) →
    H^{k+2}(Γ_Z(H^k(\sheaf F))) →
    \cdots.
\end{multline*}
    By induction, $H^\ell(Γ_Z(τ_{≤ k-1} \sheaf F))$ vanishes for $\ell ≥ 1$ so that $H^\ell(Γ_Z\sheaf F) \cong H^{k+\ell}(Γ_Z(H^k(\sheaf F)))$ for $\ell ≥ 1$.
    Thus the statement follows from Lemma~\ref{lem:supportAndLocalCohomology}.
\end{proof}


\iffalse
\begin{Thm}
    $\perv[L] D^{≤0}(X) = \perv D^{≤0}(X)$ and $\perv[L] D^{≥0}(X) = \perv D^{≥0}(X)$.
\end{Thm}

\begin{proof}
    By Lemma~\ref{lem:duality} and the corresponding statement for the perverse t-structure \cite[Lemma~5(a)]{Bezrukavnikov:arXiv:PerverseCoherentSheaves}, it is sufficient to prove the first assertion.
    All measurements are local, so we can assume that $X$ is affine and set $X = \Spec A$.

    Let us first show that $\perv[L]D^{≤0}(X) \subseteq \perv D^{≤0}(X)$.
    Let $\sheaf F ∈ \perv[L]D^{≤0}(X)$ and write $\sheaf F = \widetilde M$ for some $M ∈ D_c^b(A)$.
    Note that if $Z$ is a subvariety defined by the ideal $\ideal a$ of $M$, then $H^*(Γ_Z \sheaf F) = \widetilde{H^*_{\ideal a}(M)}$.
    We will proceed by induction on the codimension $d$ of the orbit, i.e.\ we assume that $\mathbb i_U^* \sheaf F$ is concentrated in degrees at most $-\frac12 \dim U$ for all orbits $U$ of codimension less than $d$.

    Let $Y$ be an orbit of codimension $d$ an assume that we already checked the statement for all orbits of higher dimension.
    Let $n$ be the largest integer such that $i_Y^*H^n(\sheaf F) \ne 0$.
    We have to show that $n ≤ -\frac12\dim Y$.
    For contradiction assume that this is not the case.
    Since $\sheaf F$ is concentrated in degrees at most $-\frac12\dim Y - 1$ on any larger orbits by induction, $\supp H^n(\sheaf F) ⊆ \bar Y$.
    By equivariance we also know that $\supp H^n(\sheaf F)$ contains at least $Y$, so that $\dim \left( \supp H^n(\sheaf F) \right) = \dim Y$.

    Let $Z$ be any measuring subvariety that intersects $Y$ non-trivially.
    Set $Z = V(\ideal p)$, $E = Γ(X,H^n(\sheaf F))$ and $d=\frac12\dim Y = \dim (Z∩Y)$.
    By the Grothendieck non-vanishing theorem \cite[Theorem~6.1.4]{BrodmannSharp:1998:LocalCohomology}, $H^{n+d}_{\ideal p_{\ideal p}}(M_{\ideal p}) \ne 0$ (but all higher cohomology vanishes).
    By the Flat Base Change Theorem \cite[Corollary~4.3.3]{BrodmannSharp:1998:LocalCohomology}, this is the same as $(H^{n+d}_{\ideal p}(M))_{\ideal p}$.
    Hence $H^{n+d}_{\ideal p}(M) = H^{n+d}(Γ_L\sheaf F)) \ne 0$\remark{We also need to show that we can calculate the top cohomology by only looking at the top cohomology. This follows from the Grothendieck vanishing theorom, but should be made explicit.}.
    But by assumption, $Γ_Z\sheaf F$ is concentrated in degree $0$, so that $n+d = 0$ and hence $n = -\frac12\dim Y$, contradicting the assumption.

    Let us now show that $\perv D^{≤0}(X) ⊆ \perv[L] D^{≤0}(X)$.
    It suffices to show that the condition hold for the perverse sheaves $\sheaf P(X) ⊆ \perv D^{≤0}(X)$.
    Since $Γ_Z$ is a triangulated functor, we can further reduce to irreducible perverse sheaves.
    But then the statement follows immediately from Lemma~\ref{lem:locationOfIrreducibles} and the Grothendieck vanishing theorem for local cohomology.
\end{proof}
\fi

\section{A simple description of perverse sheaves}

\begin{Claim}
    If $(p,Z)$ and $(p,Z')$ are two transversal measuring pairs and $\sheaf F ∈ D_c^b(X)$, then ${\mathbb ι_p}_*{\mathbb ι}_p^*Γ_Z \sheaf F \cong Γ_pΛ_Z \sheaf F$\footnote{Or some similar statement.}.
\end{Claim}
(\cite{AlonsoJeremiasLipman:1999:DualityAndFlatBaseChangeOnFormalSchemes} will probably be useful here.)


\begin{Cor}
    Let $\sheaf F ∈ D^b_c(X^G)$.
    Then the following are equivalent:
    \begin{enumerate}
        \item $\sheaf F$ is perverse;
        \item $Γ_Z \sheaf F$ is concentrated in degree $0$ for all measuring subvarieties $Z$;
        \item $Γ_pΛ_Z \sheaf F$ is concentrated in degree $0$ for all measuring pairs $(p,Z)$;
    \end{enumerate}
\end{Cor}

\printbibliography

\end{document}
